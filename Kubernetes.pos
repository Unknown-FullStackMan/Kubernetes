{"diagram":{"image":{"height":200,"pngdata":"iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAYAAACtWK6eAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAsUlEQVR4nO3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8GXHmAAFMgHIEAAAAAElFTkSuQmCC","width":200,"y":0,"x":0},"elements":{"id":"root","watermark":"","title":"Kubernetes","leftChildren":[],"structure":"mind_right","root":true,"theme":"delicate_caihong","children":[{"id":"e520c01f9a71","title":"K8s介绍","lineStyle":{"randomLineColor":"#BE49C4"},"children":[{"id":"c5a76cce5a1f","title":"来源谷歌Borg系统开源","parent":"e520c01f9a71","children":[]},{"id":"8dee0145f975","title":"现归属于CNCF，云原生计算基金会，官网http://www.cncf.io","parent":"e520c01f9a71","children":[]},{"id":"5f4209a965ce","title":"K8s官方网站：https://kubernetes.io","children":[],"parent":"e520c01f9a71"},{"id":"017e76a5d789","title":"容器编排部署","children":[{"id":"ce91706efef3","title":"主要用于管理云平台中多个主机上的容器化的应用，让部署容器化的应用简单并且高效，提供了应用部署、规划，更新，维护的一种机制","parent":"017e76a5d789","children":[]}],"parent":"e520c01f9a71"},{"id":"55bc92165fc2","title":"容器docker？","parent":"e520c01f9a71","children":[{"id":"18c3c93148bf","title":"为了降低虚拟机造成的物理主机资源浪费，提高物流主机的资源利用率。并能够提供像虚拟机一样良好的应用程序隔离运行环境，人们把这种轻量级的虚拟机称为容器","children":[],"parent":"55bc92165fc2"}]}],"parent":"root"},{"id":"c8b708953ffe","title":"K8s功能","lineStyle":{"randomLineColor":"#FD5155"},"parent":"root","children":[{"id":"2894b5d1cf27","title":"自动装箱","children":[{"id":"e77953e2f266","title":"基于容器对应用运行环境的资源配置要求自动部署应用容器","parent":"2894b5d1cf27","children":[]}],"parent":"c8b708953ffe"},{"id":"e15131ae0139","title":"自我修复","children":[{"id":"7f17fdd63676","title":"当容器失败时，会对容器进行重启","children":[],"parent":"e15131ae0139"},{"id":"2456584df0b8","title":"当所部署的Node节点有问题时，会对容器进行重新部署和重新调度","children":[],"parent":"e15131ae0139"},{"id":"eba0296ce7b4","title":"当容器未通过监控检查时，会关闭此容器","parent":"e15131ae0139","children":[]},{"id":"a205a07ee6a2","title":"直到容器正常运行时，才会对外提高服务","children":[],"parent":"e15131ae0139"}],"parent":"c8b708953ffe"},{"id":"11269446de3f","title":"水平扩展","children":[{"id":"c9c59f64954b","title":"通过简单的命令，用户UI界面或基于CPU等资源使用情况，对应用容器进行规模扩大或规模裁剪","children":[],"parent":"11269446de3f"}],"parent":"c8b708953ffe"},{"id":"8ea18cca7777","title":"服务发现","parent":"c8b708953ffe","children":[{"id":"5e36c503c67d","title":"用户不需要额外的服务发现机制，就能够基于kubernetes自身能力实现服务发现和负载均衡","children":[],"parent":"8ea18cca7777"}]},{"id":"73bdedd9ca55","title":"滚动更新","children":[{"id":"a824f7dacbd3","title":"可以根据应用的变化，对应用容器运行的应用，进行一次性或批量更新","parent":"73bdedd9ca55","children":[]}],"parent":"c8b708953ffe"},{"id":"887d7b4d044d","title":"版本回退","parent":"c8b708953ffe","children":[{"id":"c5eab38f763f","title":"可根据应用的变化，对应用容器运行的应用，进行历史版本即时回退","parent":"887d7b4d044d","children":[]}]},{"id":"95448d43ca27","title":"密钥和配置管理","parent":"c8b708953ffe","children":[{"id":"f33f88176f02","title":"在不需要重新构建镜像的情况下，可以部署和更新密钥和应用配置，类似热部署","parent":"95448d43ca27","children":[]}]},{"id":"cb7e7c486082","title":"存储编排","parent":"c8b708953ffe","children":[{"id":"900356f27230","title":"自动实现存储系统挂载及应用，特别对有状态应用实现数据持久化非常重要","parent":"cb7e7c486082","children":[]},{"id":"a8a5f13e05e8","title":"存储系统可以来自本地目录，网络存储（NFS，Gluster，Ceph，Cinder）、公共云存储服务等","parent":"cb7e7c486082","children":[]}]},{"id":"4b69949f2317","title":"Node和Pod支持","children":[{"id":"01f2b017ab81","title":"Node 现版本可以管理2000台","children":[],"parent":"4b69949f2317"},{"id":"e04294670932","title":"Pod 现版本可以管理150000个","children":[],"parent":"4b69949f2317"}],"parent":"c8b708953ffe"}]},{"id":"cec12f9b9590","title":"K8s架构","lineStyle":{"randomLineColor":"#7549C5"},"parent":"root","children":[{"id":"4408a82ca661","title":"Master Node","children":[{"id":"c44aa243a889","title":"k8s集群控制节点，对集群进行调度管理，接受集群外用户去集群操作请求","parent":"4408a82ca661","children":[]},{"id":"d6c2aab44e6e","title":"由API Server、Schedule、Cluster State Store（ETCD数据库）和Controller Manger Server所组成","parent":"4408a82ca661","children":[]}],"parent":"cec12f9b9590"},{"id":"f7e46ae81056","title":"Worker Node","parent":"cec12f9b9590","children":[{"id":"0873f153a511","title":"集群工作节点，运行用户业务应用容器","children":[],"parent":"f7e46ae81056"},{"id":"7e682bef6085","title":"包含kubelet、kube proxy、Container Runtime","children":[],"parent":"f7e46ae81056"}]},{"id":"31e51ce068cc","title":"Pod","parent":"cec12f9b9590","children":[{"id":"3d8c219af1a7","title":"Pod封装了一个或多个应用程序的容器(比如nginx等),存储资源,唯一的网络IP以及管理容器的一些选项Pod标示的是一个部署单元,可以理解为Kubernetes中的应用程序的单个实例,它可能由单个容器组成,也可能由少量紧密耦合并共享资源的容器组成。","parent":"31e51ce068cc","children":[]}]},{"id":"9ed95d62289d","title":"Deployment","parent":"cec12f9b9590","children":[{"id":"32a4dd5b8274","title":"在早期版本使用Replication Controller对Pod副本数量进行管理,在新的版本中官方推荐使用Deployment来代替RC,Deployment相对RC有这些好处","parent":"9ed95d62289d","children":[{"id":"18ae3ddca161","title":"Deployment拥有更加灵活强大的升级、回滚功能,并且支持滚动更新<br>","parent":"32a4dd5b8274","children":[]},{"id":"4ec84d50b7dd","title":"使用Deployment升级Pod只需要定义Pod的最终状态，k8s会为你执行必要的操作(RC要自己定义如何操作)","parent":"32a4dd5b8274","children":[]}]}]},{"id":"fb26a022f72e","title":"Service","parent":"cec12f9b9590","children":[{"id":"147d30a03b03","title":"service其实是在这一整套基础之上提供给外部的稳定的服务。","parent":"fb26a022f72e","children":[]}]},{"id":"364cf751777d","title":"ReplicaSet","parent":"cec12f9b9590","children":[{"id":"4145ac15ed9e","title":"是pod的复制抽象，用于解决pod的扩容缩容问题。通常，分布式应用为了性能或高可用性的考虑，需要复制多份资源，并且根据负载情况动态伸缩。通过replicationController，我们可以指定一个应用需要几份复制，Kubernetes将为每份复制创建一个pod，并且保证实际运行pod数量总是与该复制数量相等(例如，当前某个pod宕机时，自动创建新的pod来替换)<br>","children":[],"parent":"364cf751777d"}]},{"id":"fc4a0e7e55d9","title":"总结","parent":"cec12f9b9590","children":[{"id":"b44a55dfdd43","title":"子deploy控制RS，RS控制Pod，这一整套，向外提供稳定可靠的Service。","parent":"fc4a0e7e55d9","children":[]}]}]},{"id":"3eeb651dbe6e","title":"K8s集群部署","lineStyle":{"randomLineColor":"#02ACF4"},"parent":"root","children":[{"id":"6e0a3105bfc2","title":"kubeadm部署方式","children":[{"id":"c7a66b406054","title":"安装软件kubelet、kubeadm、kubectl","children":[],"parent":"6e0a3105bfc2"}],"parent":"3eeb651dbe6e"},{"id":"b498b1e86b6b","title":"主机准备","children":[],"parent":"3eeb651dbe6e"},{"id":"3be11a4a49c6","title":"集群软件准备","children":[],"parent":"3eeb651dbe6e"},{"id":"f57478348a48","title":"集群应用容器镜像准备","children":[],"parent":"3eeb651dbe6e"},{"id":"e9477a25b651","title":"集群初始化","children":[],"parent":"3eeb651dbe6e"},{"id":"51951a30a6e0","title":"网络附件应用","children":[],"parent":"3eeb651dbe6e"},{"id":"35a1daa8b555","title":"添加node节点到集群","parent":"3eeb651dbe6e","children":[]},{"id":"175bff41af9b","title":"集群可用性验证","children":[{"id":"d9eb8a47cf0f","title":"kubectl get node","children":[],"parent":"175bff41af9b"},{"id":"c409f4e29460","title":"kubectl get cs","parent":"175bff41af9b","children":[]},{"id":"4dc3ce158875","title":"kubectl get  pods -n kube-system","children":[],"parent":"175bff41af9b"}],"parent":"3eeb651dbe6e"}]},{"id":"b38db9a6e22d","title":"K8s集群客服端kubectl","lineStyle":{"randomLineColor":"#80BA4C"},"children":[{"id":"78cd5aaa2d6d","title":"常用命令","parent":"b38db9a6e22d","children":[{"id":"21d80d389707","title":"create","parent":"78cd5aaa2d6d","children":[]},{"id":"59f569e15ed2","title":"expose","children":[],"parent":"78cd5aaa2d6d"},{"id":"8536976452af","title":"run","parent":"78cd5aaa2d6d","children":[]},{"id":"4e80cd0dd9aa","title":"set","children":[],"parent":"78cd5aaa2d6d"},{"id":"901908cf447f","title":"get","parent":"78cd5aaa2d6d","children":[]},{"id":"f24ff2f07ac3","title":"explain","parent":"78cd5aaa2d6d","children":[]},{"id":"d5d1e15654b2","title":"delete","parent":"78cd5aaa2d6d","children":[]},{"id":"67f61bcab6ec","title":"edit","parent":"78cd5aaa2d6d","children":[]},{"id":"64dc6a764dd8","title":"cluster-info","parent":"78cd5aaa2d6d","children":[]},{"id":"e6f018cb6a7d","title":"apply","children":[],"parent":"78cd5aaa2d6d"},{"id":"10f4fc925017","title":"logs","children":[],"parent":"78cd5aaa2d6d"},{"id":"c451a6571101","title":"--help","children":[],"parent":"78cd5aaa2d6d"}]},{"id":"5ddb93a928cf","title":"在node1节点使用kubectl命令管理集群","children":[{"id":"fde2cb4f6efa","title":"mkdir .kube","children":[{"id":"b50c2d6f0ceb","title":"scp master1:/root/.kube/config&nbsp; &nbsp;.kube/","children":[],"parent":"fde2cb4f6efa"}],"parent":"5ddb93a928cf"}],"parent":"b38db9a6e22d"}],"parent":"root"},{"id":"703ccc25dd2d","title":"K8s集群资源清单YAML","lineStyle":{"randomLineColor":"#FA5465"},"children":[{"id":"e8916b570b92","title":"K8s集群对资源管理和对象编排部署都可以通过声明样式YAML文件来解决，通过kubectl命令直接使用资源清单文件就可以实现对大量的资源对象的编排部署","parent":"703ccc25dd2d","children":[]},{"id":"7b7a0c81f37d","title":"version","parent":"703ccc25dd2d","children":[{"id":"4446301a12a4","title":"指定K8s API的版本，目前基本上是v1.可以使用kubectl api-version命令查看","children":[],"parent":"7b7a0c81f37d"}]},{"id":"3b7253b4cf03","title":"kind","children":[{"id":"03281f618d6e","title":"文件定义的资源类型和角色，有Pod，Deployment，Service等","parent":"3b7253b4cf03","children":[]}],"parent":"703ccc25dd2d"},{"id":"679a4ab42db0","title":"metadata（元数据）","children":[{"id":"35c48750b70c","title":"name","children":[{"id":"b4a363a91b5b","title":"资源对象的名称，例如Pod的名字","children":[],"parent":"35c48750b70c"}],"parent":"679a4ab42db0"},{"id":"d9952748a90d","title":"namespace","children":[{"id":"c8467cb7636e","title":"元数据对象的命名空间","parent":"d9952748a90d","children":[]}],"parent":"679a4ab42db0"}],"parent":"703ccc25dd2d"},{"id":"7ac06cffc761","title":"Spec（详细定义对象描述）","parent":"703ccc25dd2d","children":[{"id":"b9c7ef14419a","title":"containers【】（容器列表定义，是个列表）","parent":"7ac06cffc761","children":[{"id":"c43ba2ecd6c6","title":"name","children":[{"id":"ca23fbfb868a","title":"容器名字","children":[],"parent":"c43ba2ecd6c6"}],"parent":"b9c7ef14419a"},{"id":"5119ebd72902","title":"image","children":[{"id":"3397c2faff5f","title":"容器镜像","children":[],"parent":"5119ebd72902"}],"parent":"b9c7ef14419a"},{"id":"286b4acb33e2","title":"imagePullPolicy","children":[{"id":"0cb20786ae6c","title":"容器镜像下载策略","children":[],"parent":"286b4acb33e2"}],"parent":"b9c7ef14419a"},{"id":"3199ebb8f806","title":"command[]","children":[{"id":"7da5b553b88c","title":"容器启动命令","children":[],"parent":"3199ebb8f806"}],"parent":"b9c7ef14419a"},{"id":"68c9f9905948","title":"args[]","children":[{"id":"175d0a29737f","title":"容器启动命令参数","children":[],"parent":"68c9f9905948"}],"parent":"b9c7ef14419a"},{"id":"4be42f9a0fac","title":"workDir","children":[{"id":"a133cb3c794b","title":"容器的工作命令","children":[],"parent":"4be42f9a0fac"}],"parent":"b9c7ef14419a"},{"id":"03f6e142f8c8","title":"volumeMoubts[]","children":[{"id":"d10f9ed09539","title":"容器内部的存储卷的配置","children":[],"parent":"03f6e142f8c8"}],"parent":"b9c7ef14419a"},{"id":"525ba5e91c3d","title":"volumeMoubts[].name","children":[{"id":"da9609583f6e","title":"挂载存储卷的名称","children":[],"parent":"525ba5e91c3d"}],"parent":"b9c7ef14419a"},{"id":"df7ee07f13d5","title":"volumeMoubts[].mountPath","children":[{"id":"4028a2266bf3","title":"挂载存储卷的路径","children":[],"parent":"df7ee07f13d5"}],"parent":"b9c7ef14419a"},{"id":"f83fe73786f1","title":"ports[]","children":[{"id":"2bd9d6ab3a87","title":"容器端口","parent":"f83fe73786f1","children":[]}],"parent":"b9c7ef14419a"},{"id":"1664fa012c16","title":"ports[].name","parent":"b9c7ef14419a","children":[{"id":"613f6ba74bd6","title":"容器端口名称","children":[],"parent":"1664fa012c16"}]},{"id":"1d63e70213a5","title":"ports[].containerPort","children":[{"id":"08e2f1ba342b","title":"容器需要监听的端口号","children":[],"parent":"1d63e70213a5"}],"parent":"b9c7ef14419a"},{"id":"9ea215fb26de","title":"ports[].hostPort","children":[{"id":"470f96469724","title":"指定容器所在主机需要监听的端口，默认和上面的containerport相同。","children":[],"parent":"9ea215fb26de"}],"parent":"b9c7ef14419a"},{"id":"290f741fa968","title":"。。。。","children":[],"parent":"b9c7ef14419a"}]}]},{"id":"8ffea0f2d0a3","title":"例","children":[{"id":"36d354f725b8","title":"创建一个namespace","children":[{"id":"71e636aa04db","title":"apiVersion:v1<br>kind:Namespace<br>metadata:<br>&nbsp; &nbsp; &nbsp;name:test","parent":"36d354f725b8","children":[]}],"parent":"8ffea0f2d0a3"},{"id":"c978817c89a1","title":"创建一个Pod","parent":"8ffea0f2d0a3","children":[{"id":"4900c71687e6","title":"apiVersion:v1<br>kind:Pod<br>metadata:<br>&nbsp; &nbsp; &nbsp; &nbsp;name:pod1<br>spec:<br>&nbsp; &nbsp;containers:<br>&nbsp; &nbsp;- name:nginx-containers<br>&nbsp; &nbsp; &nbsp; image:nginx:latest","parent":"c978817c89a1","children":[]}]}],"parent":"703ccc25dd2d"}],"parent":"root"},{"id":"2bf4ba5b6a55","title":"K8s集群命名空间namespace","lineStyle":{"randomLineColor":"#F88A35"},"children":[{"id":"7acf6a20ef80","title":"实现环境、资源隔离。属于逻辑隔离，管理边界，不属于网络边界。","children":[],"parent":"2bf4ba5b6a55"},{"id":"c530cb157354","title":"创建namespace","parent":"2bf4ba5b6a55","children":[{"id":"61aa450a95aa","title":"命令行","parent":"c530cb157354","children":[{"id":"81082294f3e2","title":"kubectl create namespace test","children":[],"parent":"61aa450a95aa"}]},{"id":"949391542692","title":"yaml","children":[{"id":"642bc23004ed","title":"apiVersion:v1<br>kind:Namespace<br>metadata:<br>&nbsp; &nbsp; &nbsp; name:test","children":[{"id":"94f039d1972c","title":"kubectl apply -f xxx.yaml","children":[],"parent":"642bc23004ed"}],"parent":"949391542692"}],"parent":"c530cb157354"}]},{"id":"e3f06ce8d790","title":"查看命名空间","parent":"2bf4ba5b6a55","children":[{"id":"8390ac8b7d76","title":"kubectl get namespace","parent":"e3f06ce8d790","children":[]}]},{"id":"8af2292043fb","title":"删除NameSpace","parent":"2bf4ba5b6a55","children":[{"id":"4b3353e8aa82","title":"kubectl&nbsp; delete namespace&nbsp; test","parent":"8af2292043fb","children":[]},{"id":"3dbaacbe2544","title":"kubectl  delete -f&nbsp; test.yaml","children":[],"parent":"8af2292043fb"}]}],"parent":"root"},{"id":"e2612add3628","title":"K8s集群核心概念Pod","lineStyle":{"randomLineColor":"#80BA4C"},"parent":"root","children":[{"id":"aa6f1f9dd601","title":"查看pod（指定namespace）","children":[{"id":"9b8d95676833","title":"kubectl get node -n kube-system","parent":"aa6f1f9dd601","children":[{"id":"5bfd933dabea","title":"kubectl get pod -o wide","children":[],"parent":"9b8d95676833"}]}],"parent":"e2612add3628"},{"id":"8bd88e2b9c95","title":"创建Pod","children":[{"id":"7e0e4d77181a","title":"apiVersion:v1<br>kind:Pod<br>metadata:<br>       name:pod1<br>spec:<br>   containers:<br>   - name:nginx-containers<br>      image:nginx:latest","parent":"8bd88e2b9c95","children":[]}],"parent":"e2612add3628"},{"id":"4820f2f9b73c","title":"删除Pod","children":[{"id":"f14da4889bed","title":"kubectl delete pods&nbsp; mypod -n xxx","children":[],"parent":"4820f2f9b73c"},{"id":"fd6b512745aa","title":"kubectl delete -f mypod.yaml","parent":"4820f2f9b73c","children":[]}],"parent":"e2612add3628"}]},{"id":"11534f755f05","title":"K8s集群核心概念Controller","lineStyle":{"randomLineColor":"#FCB52A"},"children":[{"id":"8b5039e5c401","title":"介绍","children":[{"id":"16c0ac28838a","title":"为解决误操作删除pod。k8s集群引入了一个概念Controller控制器，用于在K8s集群中以loop的方式监视Pod状态，如果发现其被删除，将会重新拉起一个Pod，以让Pod一直保持在用户期望状态","children":[],"parent":"8b5039e5c401"}],"parent":"11534f755f05"},{"id":"3c7e6c2f2749","title":"常见的Pod控制器分类","parent":"11534f755f05","children":[{"id":"32709af29f10","title":"Deployment（包含ReplicaSet，不建议直接使用RS）","children":[{"id":"0283871d53f8","title":"声明式更新控制器，用于发布无状态应用","children":[],"parent":"32709af29f10"}],"parent":"3c7e6c2f2749"},{"id":"824a4b77276c","title":"RelicaSet","parent":"3c7e6c2f2749","children":[{"id":"1b0d1875b31f","title":"副本集控制器，对于Pod进行副本规模扩大或剪裁","children":[],"parent":"824a4b77276c"}]},{"id":"0f5abb2e5967","title":"Job","children":[{"id":"2c562a53aa43","title":"运行一次性作业任务","parent":"0f5abb2e5967","children":[]}],"parent":"3c7e6c2f2749"},{"id":"893b18dbc179","title":"CronJob","children":[{"id":"df527d7cd033","title":"运行周期性作业任务","parent":"893b18dbc179","children":[]}],"parent":"3c7e6c2f2749"},{"id":"3ebd9f315992","title":"DaemonSet","parent":"3c7e6c2f2749","children":[{"id":"71a7d00e9854","title":"在K8s集群每个Node上运行一个副本，用于发布监控或日志搜集等应用","children":[],"parent":"3ebd9f315992"}]},{"id":"400100131b74","title":"StatefulSet","children":[{"id":"f676e78beb85","title":"有状态副本集，用于发布有状态应用","children":[],"parent":"400100131b74"}],"parent":"3c7e6c2f2749"}]},{"id":"cd54ad8b1066","title":"重点介绍Deployment","parent":"11534f755f05","children":[{"id":"8b1146fc6151","title":"kubectl命令创建","parent":"cd54ad8b1066","children":[{"id":"a67c4dfdf13e","title":"kubectl run nginx-app --image=nginx:latest --image-pull-policy=IfNotPresent&nbsp; --replicas=2","children":[],"parent":"8b1146fc6151"}]},{"id":"d565aa02f83b","title":"yaml创建","children":[{"id":"2bcc90e32351","title":"kubectl apply -f xxx.yaml","parent":"d565aa02f83b","children":[{"id":"14ab5378f1a5","title":"","children":[{"id":"f44fbb187470","title":"","children":[{"id":"3d1dd4523b81","title":"","children":[{"id":"498f145eb43c","title":"apiVersion: apps/v1<br>kind: Deployment<br>metadata:<br>     name: nginx-app2<br>     labels:<br>        app: nginx<br>spec:<br>     replicas: 1<br>     selector:<br>        matchLables:<br>\tapp:nginx<br>     template:<br>         metadata:<br>\tlabels:<br>\t     app:  nginx<br>         spec:<br>\tcontainers:<br>\t- name: nginxxapp<br>\t  image: nginx:latest<br>\t  imagePullPolicy:IfNotRresent<br>\t ports:<br>\t - name: nginxapp2<br>\t   containerPort: 80","parent":"3d1dd4523b81","children":[]}],"parent":"f44fbb187470"}],"parent":"14ab5378f1a5"}],"parent":"2bcc90e32351"}]}],"parent":"cd54ad8b1066"},{"id":"da509fe04719","title":"查看","children":[{"id":"f1ac0f6fa51b","title":"kubectl get deployment -n&nbsp; xx","children":[],"parent":"da509fe04719"},{"id":"b7c2c1983990","title":"kubectl get rs -n  xx","children":[],"parent":"da509fe04719"}],"parent":"cd54ad8b1066"},{"id":"4bbc21950bd5","title":"删除","children":[{"id":"fc5f9ecb0c61","title":"kubectl delete deployment.apps&nbsp; xxx","children":[],"parent":"4bbc21950bd5"},{"id":"b95a7157b523","title":"kubectl delete -f&nbsp; xxx.yaml","parent":"4bbc21950bd5","children":[]}],"parent":"cd54ad8b1066"}]}],"parent":"root"},{"id":"5b7ae34466e8","title":"K8s集群核心概念Service","lineStyle":{"randomLineColor":"#DD489D"},"parent":"root","children":[{"id":"4079644567d0","title":"介绍","children":[{"id":"47038e898b23","title":"误删的Pod，被Controller拉取后IP会变化，为了更好的控制Pod与之通信，引入service","children":[],"parent":"4079644567d0"},{"id":"f547cc505d6b","title":"不是实体服务","parent":"4079644567d0","children":[]},{"id":"0327cc02080b","title":"是一条iptables或ipvs的转发规则","parent":"4079644567d0","children":[]}],"parent":"5b7ae34466e8"},{"id":"bbd163db55b4","title":"作用","children":[{"id":"e8553ee7d66d","title":"通过Service为Pod客服端提供访问Pod的方法，即客服端访问Pod的入口","children":[],"parent":"bbd163db55b4"},{"id":"a4100e0dddf0","title":"Service通过Pod标签与Pod进行关联","parent":"bbd163db55b4","children":[]}],"parent":"5b7ae34466e8"},{"id":"1491405edd42","title":"类型","children":[{"id":"ac03a729c001","title":"Cluster IP","children":[{"id":"a956a9a1e6ab","title":"默认，分配一个集群内部可以访问的虚拟IP","parent":"ac03a729c001","children":[]}],"parent":"1491405edd42"},{"id":"1bb555ba100b","title":"NodePort","parent":"1491405edd42","children":[{"id":"bd4d64904ae3","title":"分配一个端口作为外部访问入口","children":[],"parent":"1bb555ba100b"}]},{"id":"37f6416acb98","title":"LoadBalancer","children":[{"id":"5ca2eb206f1c","title":"工作在特定的Cloud Provide上，eg. Google CLoud AWS OpenStack","parent":"37f6416acb98","children":[]}],"parent":"1491405edd42"},{"id":"0cb883a6d824","title":"External Name","parent":"1491405edd42","children":[{"id":"f6f66b3b7cf7","title":"表示把集群外部访问引入集群内部来，实现集群内部Pod和集群外部的服务进行通信","children":[],"parent":"0cb883a6d824"}]}],"parent":"5b7ae34466e8"},{"id":"3a41ae8aa78f","title":"参数","children":[{"id":"e38ad0efa3be","title":"port","children":[{"id":"a88af425c863","title":"访问service使用的端口","children":[],"parent":"e38ad0efa3be"}],"parent":"3a41ae8aa78f"},{"id":"565e48ef4a91","title":"targetPort","parent":"3a41ae8aa78f","children":[{"id":"f52170e875b8","title":"Pod中容器的端口","parent":"565e48ef4a91","children":[]}]},{"id":"d7706df05833","title":"NodePort","children":[{"id":"990bade8f62e","title":"通过NodePort实现外网用户访问K8s集群内service","children":[],"parent":"d7706df05833"}],"parent":"3a41ae8aa78f"}],"parent":"5b7ae34466e8"},{"id":"d7f99b4f9341","title":"创建","children":[{"id":"6adf3a28ea84","title":"创建service先创建pod，创建pod就要创建deployment","children":[{"id":"f93ea7c484b7","title":"kubectl expose deployment.apps nginx-app1 --type=ClusterIP&nbsp; --target-port=80","children":[],"parent":"6adf3a28ea84"},{"id":"96d5d4896d3d","title":"apiVersion:v1<br>kind:Service<br>metadata:<br>&nbsp; name:nginx-app2<br>spec:<br>&nbsp; &nbsp;type:ClusterIP<br>&nbsp; &nbsp;ports:<br>&nbsp; &nbsp;- protocol:TCP<br>&nbsp; &nbsp; &nbsp;port:80<br>&nbsp; &nbsp; &nbsp;targetPort:80<br>&nbsp; &nbsp;selector:<br>&nbsp; &nbsp; &nbsp; apps:nginx","parent":"6adf3a28ea84","children":[]}],"parent":"d7f99b4f9341"}],"parent":"5b7ae34466e8"},{"id":"4bbb8074c504","title":"查看","children":[{"id":"a7768a40fc08","title":"kubectl get service","children":[],"parent":"4bbb8074c504"},{"id":"baa86265ddd5","title":"kubectl get endpoints查看service与pod的连接点","children":[],"parent":"4bbb8074c504"}],"parent":"5b7ae34466e8"},{"id":"e1adba8668ed","title":"删除","parent":"5b7ae34466e8","children":[{"id":"9fc147da7be9","title":"kubectl delete service xxx","parent":"e1adba8668ed","children":[]},{"id":"5d39f30aa48e","title":"kubectl delete -f xx.yaml","children":[],"parent":"e1adba8668ed"}]},{"id":"2ed959c67dcf","title":"负载均衡","parent":"5b7ae34466e8","children":[]}]}],"note":""}},"meta":{"id":"6041a59ae401fd641ae0f8b7","member":"6009505ef346fb77714aee48","exportTime":"2021-03-19 15:23:14","diagramInfo":{"category":"mind_free","title":"Kubernetes","created":"2021-03-05 11:29:31","creator":"6009505ef346fb77714aee48","modified":"2021-03-05 18:19:35"},"type":"ProcessOn Schema File","version":"1.0"}}